# PMLDL Assignment 1: MLOps Model Deployment

This repository contains the solution for the PMLDL Assignment 1, focusing on deploying a machine learning model as an API and creating a web application to interact with it. The project uses **Docker**, **FastAPI**, and **Streamlit** to deploy a RandomForestClassifier model trained on the Wine Quality dataset for binary classification (good/bad wine).

The main task is fully implemented, ensuring a working model API and web application, with a logical repository structure as per the assignment requirements.

## Repository Structure

```
├── code
│   ├── datasets        # Dataset storage (optional, not pushed)
│   ├── deployment
│   │   ├── api         # FastAPI model API code and Dockerfile
│   │   └── app         # Streamlit web app code and Dockerfile
│   └── models          # Model training script
├── data                # Placeholder for raw data (not pushed)
├── models              # Trained model (wine_model.pkl)
└── README.md           # This file
```

## Prerequisites

To run this project, you need:
- **Docker** and **Docker Compose** installed ([Docker Installation Guide](https://docs.docker.com/get-started/)).
- **Git** to clone the repository.
- Python 3.9+ (optional, for local testing outside Docker).

## Setup and Installation

Follow these steps to set up and run the project:

1. **Clone the repository**:
   ```bash
   git clone https://github.com/oneozerova/PMLDL-Assignment-1.git
   cd PMLDL-Assignment-1
   ```

2. **Build and run with Docker Compose**:
   From the `code/deployment` directory, build and start the containers:
   ```bash
   cd code/deployment
   docker-compose build
   docker-compose up -d
   ```
   - The FastAPI model API will be available at `http://localhost:8000`.
   - The Streamlit web app will be available at `http://localhost:8501`.

3. **Verify the services**:
   - Check the API: Open `http://localhost:8000/docs` in your browser to access the FastAPI Swagger UI. Test the `/predict` endpoint with a sample input.
   - Check the web app: Open `http://localhost:8501` to interact with the Streamlit interface.
   - View logs if needed:
     ```bash
     docker-compose logs -f
     ```

4. **Stop the containers**:
   When done, stop the services:
   ```bash
   docker-compose down
   ```

## Usage

1. **Access the Streamlit web app**:
   - Navigate to `http://localhost:8501`.
   - Enter the wine features (e.g., fixed acidity, volatile acidity, etc.) in the input fields.
   - Click the "Predict" button to get the prediction ("Good wine" or "Bad wine").

2. **Example Input**:
   ```json
   {
     "fixed_acidity": 7.4,
     "volatile_acidity": 0.7,
     "citric_acid": 0.0,
     "residual_sugar": 1.9,
     "chlorides": 0.076,
     "free_sulfur_dioxide": 11.0,
     "total_sulfur_dioxide": 34.0,
     "density": 0.9978,
     "pH": 3.51,
     "sulphates": 0.56,
     "alcohol": 9.4
   }
   ```
   Expected output: Prediction displayed as "Good wine" or "Bad wine".

3. **Test the API directly** (optional):
   - Use the FastAPI Swagger UI at `http://localhost:8000/docs`.
   - Send a POST request to `/predict` with the JSON above to receive a prediction.

## Project Details

- **Dataset**: Wine Quality dataset (red wine) from UCI, used for binary classification (quality ≥ 6 is "Good", else "Bad").
- **Model**: RandomForestClassifier from scikit-learn, trained and saved as `wine_model.pkl`.
- **API**: Built with FastAPI, hosted in a Docker container, accepts POST requests at `/predict`.
- **Web App**: Built with Streamlit, provides a user-friendly interface to input wine features and display predictions.
- **Docker**: Both API and web app are containerized, orchestrated with `docker-compose.yml`.

## Dependencies

The project uses the following Python packages (installed via Docker):
- **API**: `fastapi`, `uvicorn`, `scikit-learn`, `joblib`, `pydantic`, `numpy`.
- **Web App**: `streamlit`, `requests`, `pandas`.
- **Model Training**: `pandas`, `scikit-learn`, `joblib`.

See `code/deployment/api/requirements.txt` and `code/deployment/app/requirements.txt` for exact versions.

## Troubleshooting

- **API not responding**: Ensure the model file (`wine_model.pkl`) is in the `models/` directory and accessible to the API container. Check logs with `docker-compose logs api`.
- **Streamlit not loading**: Verify the API is running (`http://localhost:8000/docs`) and the `depends_on` in `docker-compose.yml` is set correctly.
- **Docker issues**: Run `docker-compose build --no-cache` to rebuild images if changes are not applied.

## Useful Links

- [Docker Tutorial](https://docs.docker.com/get-started/)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Streamlit Documentation](https://docs.streamlit.io/)
